-- 직원테이블
CREATE TABLE employee(
	eid		INT(20)		NOT NULL AUTO_INCREMENT,
	name 	VARCHAR(50),
	passwd		VARCHAR(50),
	gender	VARCHAR(50),
	birth		DATE,
	phone		VARCHAR(50),
	salary		INT(20),
	type		VARCHAR(50),
	catid		INT(20),
	PRIMARY KEY(eid)
);

-- 입원할때 사용하는 방
CREATE TABLE room(
	rid		INT(20)		NOT NULL AUTO_INCREMENT,
	roomnuber 	INT(20)		NOT NULL,
	totalbeds	INT(20),		
	availablebeds	INT(20),
	PRIMARY KEY(rid)
);

-- 환자테이블
CREATE TABLE patient(
	pid					INT(20)		NOT NULL	AUTO_INCREMENT,
	name 				VARCHAR(50),
	gender				VARCHAR(50),
	phone				VARCHAR(50),
	birth				DATE,
	reservation_day		DATE NOT NULL,
	reservation_time 	varchar(50) NOT NULL,
	door				VARCHAR(50)	default null,		-- 입원인지
	eid					INT(20)		NOT NULL,
	rid 				INT(20),
	PRIMARY KEY(pid),
	FOREIGN KEY(eid) REFERENCES employee(eid),
    FOREIGN KEY(rid) REFERENCES room(rid)
);


-- 무슨 과인지 
CREATE TABLE category(
	catid		INT(20)		NOT NULL AUTO_INCREMENT,
	name		VARCHAR(30)	NOT NULL,
	PRIMARY KEY(catid)
);


-- 의사가 진료시 약 처방할때 사용하는 테이블
CREATE TABLE medicine(
	mid 		INT(20)		NOT NULL AUTO_INCREMENT,
	name		VARCHAR(20),
	type		VARCHAR(20),
	
	PRIMARY KEY(mid)
);

-- 간호사가 약 재고관리시 사용
CREATE TABLE medicine_inventory(
	id		INT(20)		NOT NULL AUTO_INCREMENT,
	name		VARCHAR(50),
	price		INT(20),
	count		INT(20),
	PRIMARY KEY(id)
);

-- 환자 기록 소견서
CREATE TABLE doctornote( 
	dnid		INT(20)		NOT NULL AUTO_INCREMENT,
	symptom	VARCHAR(300)		default null,   -- 환자의 증상을 기록하는곳
	note		VARCHAR(300)	default null, 		-- 의사의 소견
	day		DATETIME	NOT NULL, 				-- 소견서 적은날짜
	PRIMARY KEY(dnid),
	FOREIGN KEY(dnid) REFERENCES patient(pid) on delete cascade on update cascade
);

-- 환자 약처방전
CREATE TABLE prescription(
	prid		INT(20)		NOT NULL AUTO_INCREMENT,
	mname		VARCHAR(50),		-- 약이름
	day			INT(100)		NOT NULL, -- 몇일동안 처먹는지
	number		INT(100)	NOT NULL,	 -- 투여량
	dnid		INT(20)		NOT NULL,
	PRIMARY KEY(prid),
	FOREIGN KEY(dnid) REFERENCES doctornote(dnid) on delete cascade on update cascade
);
 